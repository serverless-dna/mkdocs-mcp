#!/usr/bin/env node
"use strict";var v=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ve=v((cu,Et)=>{"use strict";var Q=e=>e&&typeof e.message=="string",Ee=e=>{if(!e)return;let t=e.cause;if(typeof t=="function"){let r=e.cause();return Q(r)?r:void 0}else return Q(t)?t:void 0},St=(e,t)=>{if(!Q(e))return"";let r=e.stack||"";if(t.has(e))return r+`
causes have become circular...`;let n=Ee(e);return n?(t.add(e),r+`
caused by: `+St(n,t)):r},Gn=e=>St(e,new Set),_t=(e,t,r)=>{if(!Q(e))return"";let n=r?"":e.message||"";if(t.has(e))return n+": ...";let i=Ee(e);if(i){t.add(e);let o=typeof e.cause=="function";return n+(o?"":": ")+_t(i,t,o)}else return n},Hn=e=>_t(e,new Set);Et.exports={isErrorLike:Q,getErrorCause:Ee,stackWithCauses:Gn,messageWithCauses:Hn}});var Oe=v((au,Ot)=>{"use strict";var Xn=Symbol("circular-ref-tag"),ne=Symbol("pino-raw-err-ref"),vt=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[ne]},set:function(e){this[ne]=e}}});Object.defineProperty(vt,ne,{writable:!0,value:{}});Ot.exports={pinoErrProto:vt,pinoErrorSymbols:{seen:Xn,rawSymbol:ne}}});var $t=v((hu,Lt)=>{"use strict";Lt.exports=Le;var{messageWithCauses:Yn,stackWithCauses:Qn,isErrorLike:xt}=ve(),{pinoErrProto:Zn,pinoErrorSymbols:ei}=Oe(),{seen:xe}=ei,{toString:ti}=Object.prototype;function Le(e){if(!xt(e))return e;e[xe]=void 0;let t=Object.create(Zn);t.type=ti.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=Yn(e),t.stack=Qn(e),Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>Le(r)));for(let r in e)if(t[r]===void 0){let n=e[r];xt(n)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(n,xe)&&(t[r]=Le(n)):t[r]=n}return delete e[xe],t.raw=e,t}});var jt=v((du,At)=>{"use strict";At.exports=se;var{isErrorLike:$e}=ve(),{pinoErrProto:ri,pinoErrorSymbols:ni}=Oe(),{seen:ie}=ni,{toString:ii}=Object.prototype;function se(e){if(!$e(e))return e;e[ie]=void 0;let t=Object.create(ri);t.type=ii.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=e.message,t.stack=e.stack,Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>se(r))),$e(e.cause)&&!Object.prototype.hasOwnProperty.call(e.cause,ie)&&(t.cause=se(e.cause));for(let r in e)if(t[r]===void 0){let n=e[r];$e(n)?Object.prototype.hasOwnProperty.call(n,ie)||(t[r]=se(n)):t[r]=n}return delete e[ie],t.raw=e,t}});var Bt=v((yu,kt)=>{"use strict";kt.exports={mapHttpRequest:si,reqSerializer:Rt};var Ae=Symbol("pino-raw-req-ref"),Tt=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[Ae]},set:function(e){this[Ae]=e}}});Object.defineProperty(Tt,Ae,{writable:!0,value:{}});function Rt(e){let t=e.info||e.socket,r=Object.create(Tt);if(r.id=typeof e.id=="function"?e.id():e.id||(e.info?e.info.id:void 0),r.method=e.method,e.originalUrl)r.url=e.originalUrl;else{let n=e.path;r.url=typeof n=="string"?n:e.url?e.url.path||e.url:void 0}return e.query&&(r.query=e.query),e.params&&(r.params=e.params),r.headers=e.headers,r.remoteAddress=t&&t.remoteAddress,r.remotePort=t&&t.remotePort,r.raw=e.raw||e,r}function si(e){return{req:Rt(e)}}});var Dt=v((mu,It)=>{"use strict";It.exports={mapHttpResponse:oi,resSerializer:qt};var je=Symbol("pino-raw-res-ref"),Ct=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[je]},set:function(e){this[je]=e}}});Object.defineProperty(Ct,je,{writable:!0,value:{}});function qt(e){let t=Object.create(Ct);return t.statusCode=e.headersSent?e.statusCode:null,t.headers=e.getHeaders?e.getHeaders():e._headers,t.raw=e,t}function oi(e){return{res:qt(e)}}});var Re=v((gu,Nt)=>{"use strict";var Te=$t(),li=jt(),oe=Bt(),le=Dt();Nt.exports={err:Te,errWithCause:li,mapHttpRequest:oe.mapHttpRequest,mapHttpResponse:le.mapHttpResponse,req:oe.reqSerializer,res:le.resSerializer,wrapErrorSerializer:function(t){return t===Te?t:function(n){return t(Te(n))}},wrapRequestSerializer:function(t){return t===oe.reqSerializer?t:function(n){return t(oe.reqSerializer(n))}},wrapResponseSerializer:function(t){return t===le.resSerializer?t:function(n){return t(le.resSerializer(n))}}}});var ke=v((pu,Pt)=>{"use strict";function fi(e,t){return t}Pt.exports=function(){let t=Error.prepareStackTrace;Error.prepareStackTrace=fi;let r=new Error().stack;if(Error.prepareStackTrace=t,!Array.isArray(r))return;let n=r.slice(2),i=[];for(let o of n)o&&i.push(o.getFileName());return i}});var Wt=v((bu,Mt)=>{"use strict";Mt.exports=ui;function ui(e={}){let{ERR_PATHS_MUST_BE_STRINGS:t=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:r=n=>`fast-redact \u2013 Invalid path (${n})`}=e;return function({paths:i}){i.forEach(o=>{if(typeof o!="string")throw Error(t());try{if(/ã€‡/.test(o))throw Error();let a=(o[0]==="["?"":".")+o.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(a)||/\/\*/.test(a))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${a}
            if ([o${a}].length !== 1) throw Error()`)()}catch{throw Error(r(o))}})}}});var fe=v((wu,zt)=>{"use strict";zt.exports=/[^.[\]]+|\[((?:.)*?)\]/g});var Vt=v((Su,Ft)=>{"use strict";var ci=fe();Ft.exports=ai;function ai({paths:e}){let t=[];var r=0;let n=e.reduce(function(i,o,a){var f=o.match(ci).map(u=>u.replace(/'|"|`/g,""));let c=o[0]==="[";f=f.map(u=>u[0]==="["?u.substr(1,u.length-2):u);let h=f.indexOf("*");if(h>-1){let u=f.slice(0,h),l=u.join("."),p=f.slice(h+1,f.length),d=p.length>0;r++,t.push({before:u,beforeStr:l,after:p,nested:d})}else i[o]={path:f,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(o),leadingBracket:c};return i},{});return{wildcards:t,wcLen:r,secret:n}}});var Ut=v((_u,Kt)=>{"use strict";var hi=fe();Kt.exports=di;function di({secret:e,serialize:t,wcLen:r,strict:n,isCensorFct:i,censorFctTakesPath:o},a){let f=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${pi(n,t)}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${yi(e,i,o)}
    this.compileRestore()
    ${mi(r>0,i,o)}
    this.secret = originalSecret
    ${gi(t)}
  `).bind(a);return f.state=a,t===!1&&(f.restore=c=>a.restore(c)),f}function yi(e,t,r){return Object.keys(e).map(n=>{let{escPath:i,leadingBracket:o,path:a}=e[n],f=o?1:0,c=o?"":".",h=[];for(var u;(u=hi.exec(n))!==null;){let[,s]=u,{index:g,input:m}=u;g>f&&h.push(m.substring(0,g-(s?0:1)))}var l=h.map(s=>`o${c}${s}`).join(" && ");l.length===0?l+=`o${c}${n} != null`:l+=` && o${c}${n} != null`;let p=`
      switch (true) {
        ${h.reverse().map(s=>`
          case o${c}${s} === censor:
            secret[${i}].circle = ${JSON.stringify(s)}
            break
        `).join(`
`)}
      }
    `,d=r?`val, ${JSON.stringify(a)}`:"val";return`
      if (${l}) {
        const val = o${c}${n}
        if (val === censor) {
          secret[${i}].precensored = true
        } else {
          secret[${i}].val = val
          o${c}${n} = ${t?`censor(${d})`:"censor"}
          ${p}
        }
      }
    `}).join(`
`)}function mi(e,t,r){return e===!0?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${t}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${t}, ${r})
      }
    }
  `:""}function gi(e){return e===!1?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}function pi(e,t){return e===!0?"throw Error('fast-redact: primitives cannot be redacted')":t===!1?"return o":"return this.serialize(o)"}});var Ce=v((Eu,Ht)=>{"use strict";Ht.exports={groupRedact:wi,groupRestore:bi,nestedRedact:_i,nestedRestore:Si};function bi({keys:e,values:t,target:r}){if(r==null||typeof r=="string")return;let n=e.length;for(var i=0;i<n;i++){let o=e[i];r[o]=t[i]}}function wi(e,t,r,n,i){let o=Jt(e,t);if(o==null||typeof o=="string")return{keys:null,values:null,target:o,flat:!0};let a=Object.keys(o),f=a.length,c=t.length,h=i?[...t]:void 0,u=new Array(f);for(var l=0;l<f;l++){let p=a[l];u[l]=o[p],i?(h[c]=p,o[p]=r(o[p],h)):n?o[p]=r(o[p]):o[p]=r}return{keys:a,values:u,target:o,flat:!0}}function Si(e){for(let t=0;t<e.length;t++){let{target:r,path:n,value:i}=e[t],o=r;for(let a=n.length-1;a>0;a--)o=o[n[a]];o[n[0]]=i}}function _i(e,t,r,n,i,o,a){let f=Jt(t,r);if(f==null)return;let c=Object.keys(f),h=c.length;for(var u=0;u<h;u++){let l=c[u];Ei(e,f,l,r,n,i,o,a)}return e}function Be(e,t){return e!=null?"hasOwn"in Object?Object.hasOwn(e,t):Object.prototype.hasOwnProperty.call(e,t):!1}function Ei(e,t,r,n,i,o,a,f){let c=i.length,h=c-1,u=r;var l=-1,p,d,s,g=null,m=null,S,b,w=!1,_=0,O=0,x=vi();if(s=p=t[r],typeof p=="object"){for(;p!=null&&++l<c&&(O+=1,r=i[l],g=s,!(r!=="*"&&!m&&!(typeof p=="object"&&r in p)));)if(!(r==="*"&&(m==="*"&&(w=!0),m=r,l!==h))){if(m){let $=Object.keys(p);for(var L=0;L<$.length;L++){let E=$[L];if(b=p[E],S=r==="*",w)x=W(x,E,O),_=l,s=Gt(b,_-1,r,n,i,o,a,f,u,p,d,s,S,E,l,h,x,e,t[u],O+1);else if(S||typeof b=="object"&&b!==null&&r in b){if(S?s=b:s=b[r],d=l!==h?s:a?f?o(s,[...n,u,...i]):o(s):o,S){let A=Z(W(x,E,O),s,t[u]);e.push(A),p[E]=d}else if(b[r]!==d)if(d===void 0&&o!==void 0||Be(b,r)&&d===s)x=W(x,E,O);else{x=W(x,E,O);let A=Z(W(x,r,O+1),s,t[u]);e.push(A),b[r]=d}}}m=null}else{if(s=p[r],x=W(x,r,O),d=l!==h?s:a?f?o(s,[...n,u,...i]):o(s):o,!(Be(p,r)&&d===s||d===void 0&&o!==void 0)){let $=Z(x,s,t[u]);e.push($),p[r]=d}p=p[r]}if(typeof p!="object")break}}}function Jt(e,t){for(var r=-1,n=t.length,i=e;i!=null&&++r<n;)i=i[t[r]];return i}function Gt(e,t,r,n,i,o,a,f,c,h,u,l,p,d,s,g,m,S,b,w){if(t===0&&(p||typeof e=="object"&&e!==null&&r in e)){if(p?l=e:l=e[r],u=s!==g?l:a?f?o(l,[...n,c,...i]):o(l):o,p){let _=Z(m,l,b);S.push(_),h[d]=u}else if(e[r]!==u){if(!(u===void 0&&o!==void 0||Be(e,r)&&u===l)){let _=Z(W(m,r,w+1),l,b);S.push(_),e[r]=u}}}for(let _ in e)typeof e[_]=="object"&&(m=W(m,_,w),Gt(e[_],t-1,r,n,i,o,a,f,c,h,u,l,p,d,s,g,m,S,b,w+1))}function vi(){return{parent:null,key:null,children:[],depth:0}}function W(e,t,r){if(e.depth===r)return W(e.parent,t,r);var n={parent:e,key:t,depth:r,children:[]};return e.children.push(n),n}function Z(e,t,r){let n=e,i=[];do i.push(n.key),n=n.parent;while(n.parent!=null);return{path:i,value:t,target:r}}});var Yt=v((vu,Xt)=>{"use strict";var{groupRestore:Oi,nestedRestore:xi}=Ce();Xt.exports=Li;function Li(){return function(){if(this.restore){this.restore.state.secret=this.secret;return}let{secret:t,wcLen:r}=this,n=Object.keys(t),i=$i(t,n),o=r>0,a=o?{secret:t,groupRestore:Oi,nestedRestore:xi}:{secret:t};this.restore=Function("o",Ai(i,n,o)).bind(a),this.restore.state=a}}function $i(e,t){return t.map(r=>{let{circle:n,escPath:i,leadingBracket:o}=e[r],f=n?`o.${n} = secret[${i}].val`:`o${o?"":"."}${r} = secret[${i}].val`,c=`secret[${i}].val = undefined`;return`
      if (secret[${i}].val !== undefined) {
        try { ${f} } catch (e) {}
        ${c}
      }
    `}).join("")}function Ai(e,t,r){return`
    const secret = this.secret
    ${r===!0?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${t.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:""}
    ${e}
    return o
  `}});var Zt=v((Ou,Qt)=>{"use strict";Qt.exports=ji;function ji(e){let{secret:t,censor:r,compileRestore:n,serialize:i,groupRedact:o,nestedRedact:a,wildcards:f,wcLen:c}=e,h=[{secret:t,censor:r,compileRestore:n}];return i!==!1&&h.push({serialize:i}),c>0&&h.push({groupRedact:o,nestedRedact:a,wildcards:f,wcLen:c}),Object.assign(...h)}});var rr=v((xu,tr)=>{"use strict";var er=Wt(),Ti=Vt(),Ri=Ut(),ki=Yt(),{groupRedact:Bi,nestedRedact:Ci}=Ce(),qi=Zt(),Ii=fe(),Di=er(),qe=e=>e;qe.restore=qe;var Ni="[REDACTED]";Ie.rx=Ii;Ie.validator=er;tr.exports=Ie;function Ie(e={}){let t=Array.from(new Set(e.paths||[])),r="serialize"in e&&(e.serialize===!1||typeof e.serialize=="function")?e.serialize:JSON.stringify,n=e.remove;if(n===!0&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let i=n===!0?void 0:"censor"in e?e.censor:Ni,o=typeof i=="function",a=o&&i.length>1;if(t.length===0)return r||qe;Di({paths:t,serialize:r,censor:i});let{wildcards:f,wcLen:c,secret:h}=Ti({paths:t,censor:i}),u=ki(),l="strict"in e?e.strict:!0;return Ri({secret:h,wcLen:c,serialize:r,strict:l,isCensorFct:o,censorFctTakesPath:a},qi({secret:h,censor:i,compileRestore:u,serialize:r,groupRedact:Bi,nestedRedact:Ci,wildcards:f,wcLen:c}))}});var H=v((Lu,nr)=>{"use strict";var Pi=Symbol("pino.setLevel"),Mi=Symbol("pino.getLevel"),Wi=Symbol("pino.levelVal"),zi=Symbol("pino.levelComp"),Fi=Symbol("pino.useLevelLabels"),Vi=Symbol("pino.useOnlyCustomLevels"),Ki=Symbol("pino.mixin"),Ui=Symbol("pino.lsCache"),Ji=Symbol("pino.chindings"),Gi=Symbol("pino.asJson"),Hi=Symbol("pino.write"),Xi=Symbol("pino.redactFmt"),Yi=Symbol("pino.time"),Qi=Symbol("pino.timeSliceIndex"),Zi=Symbol("pino.stream"),es=Symbol("pino.stringify"),ts=Symbol("pino.stringifySafe"),rs=Symbol("pino.stringifiers"),ns=Symbol("pino.end"),is=Symbol("pino.formatOpts"),ss=Symbol("pino.messageKey"),os=Symbol("pino.errorKey"),ls=Symbol("pino.nestedKey"),fs=Symbol("pino.nestedKeyStr"),us=Symbol("pino.mixinMergeStrategy"),cs=Symbol("pino.msgPrefix"),as=Symbol("pino.wildcardFirst"),hs=Symbol.for("pino.serializers"),ds=Symbol.for("pino.formatters"),ys=Symbol.for("pino.hooks"),ms=Symbol.for("pino.metadata");nr.exports={setLevelSym:Pi,getLevelSym:Mi,levelValSym:Wi,levelCompSym:zi,useLevelLabelsSym:Fi,mixinSym:Ki,lsCacheSym:Ui,chindingsSym:Ji,asJsonSym:Gi,writeSym:Hi,serializersSym:hs,redactFmtSym:Xi,timeSym:Yi,timeSliceIndexSym:Qi,streamSym:Zi,stringifySym:es,stringifySafeSym:ts,stringifiersSym:rs,endSym:ns,formatOptsSym:is,messageKeySym:ss,errorKeySym:os,nestedKeySym:ls,wildcardFirstSym:as,needsMetadataGsym:ms,useOnlyCustomLevelsSym:Vi,formattersSym:ds,hooksSym:ys,nestedKeyStrSym:fs,mixinMergeStrategySym:us,msgPrefixSym:cs}});var Pe=v(($u,lr)=>{"use strict";var Ne=rr(),{redactFmtSym:gs,wildcardFirstSym:ue}=H(),{rx:De,validator:ps}=Ne,ir=ps({ERR_PATHS_MUST_BE_STRINGS:()=>"pino \u2013 redacted paths must be strings",ERR_INVALID_PATH:e=>`pino \u2013 redact paths array contains an invalid path (${e})`}),sr="[Redacted]",or=!1;function bs(e,t){let{paths:r,censor:n}=ws(e),i=r.reduce((f,c)=>{De.lastIndex=0;let h=De.exec(c),u=De.exec(c),l=h[1]!==void 0?h[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):h[0];if(l==="*"&&(l=ue),u===null)return f[l]=null,f;if(f[l]===null)return f;let{index:p}=u,d=`${c.substr(p,c.length-1)}`;return f[l]=f[l]||[],l!==ue&&f[l].length===0&&f[l].push(...f[ue]||[]),l===ue&&Object.keys(f).forEach(function(s){f[s]&&f[s].push(d)}),f[l].push(d),f},{}),o={[gs]:Ne({paths:r,censor:n,serialize:t,strict:or})},a=(...f)=>t(typeof n=="function"?n(...f):n);return[...Object.keys(i),...Object.getOwnPropertySymbols(i)].reduce((f,c)=>{if(i[c]===null)f[c]=h=>a(h,[c]);else{let h=typeof n=="function"?(u,l)=>n(u,[c,...l]):n;f[c]=Ne({paths:i[c],censor:h,serialize:t,strict:or})}return f},o)}function ws(e){if(Array.isArray(e))return e={paths:e,censor:sr},ir(e),e;let{paths:t,censor:r=sr,remove:n}=e;if(Array.isArray(t)===!1)throw Error("pino \u2013 redact must contain an array of strings");return n===!0&&(r=void 0),ir({paths:t,censor:r}),{paths:t,censor:r}}lr.exports=bs});var ur=v((Au,fr)=>{"use strict";var Ss=()=>"",_s=()=>`,"time":${Date.now()}`,Es=()=>`,"time":${Math.round(Date.now()/1e3)}`,vs=()=>`,"time":"${new Date(Date.now()).toISOString()}"`;fr.exports={nullTime:Ss,epochTime:_s,unixTime:Es,isoTime:vs}});var ar=v((ju,cr)=>{"use strict";function Os(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}cr.exports=xs;function xs(e,t,r){var n=r&&r.stringify||Os,i=1;if(typeof e=="object"&&e!==null){var o=t.length+i;if(o===1)return e;var a=new Array(o);a[0]=n(e);for(var f=1;f<o;f++)a[f]=n(t[f]);return a.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var h="",u=1-i,l=-1,p=e&&e.length||0,d=0;d<p;){if(e.charCodeAt(d)===37&&d+1<p){switch(l=l>-1?l:0,e.charCodeAt(d+1)){case 100:case 102:if(u>=c||t[u]==null)break;l<d&&(h+=e.slice(l,d)),h+=Number(t[u]),l=d+2,d++;break;case 105:if(u>=c||t[u]==null)break;l<d&&(h+=e.slice(l,d)),h+=Math.floor(Number(t[u])),l=d+2,d++;break;case 79:case 111:case 106:if(u>=c||t[u]===void 0)break;l<d&&(h+=e.slice(l,d));var s=typeof t[u];if(s==="string"){h+="'"+t[u]+"'",l=d+2,d++;break}if(s==="function"){h+=t[u].name||"<anonymous>",l=d+2,d++;break}h+=n(t[u]),l=d+2,d++;break;case 115:if(u>=c)break;l<d&&(h+=e.slice(l,d)),h+=String(t[u]),l=d+2,d++;break;case 37:l<d&&(h+=e.slice(l,d)),h+="%",l=d+2,d++,u--;break}++u}++d}return l===-1?e:(l<p&&(h+=e.slice(l)),h)}});var We=v((Tu,Me)=>{"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let t=function(r){if((r>0&&r<1/0)===!1)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(e,0,0,Number(r))},e=new Int32Array(new SharedArrayBuffer(4));Me.exports=t}else{let e=function(t){if((t>0&&t<1/0)===!1)throw typeof t!="number"&&typeof t!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let n=Date.now()+Number(t);for(;n>Date.now(););};Me.exports=e}});var wr=v((Ru,br)=>{"use strict";var j=require("fs"),Ls=require("events"),$s=require("util").inherits,hr=require("path"),Fe=We(),As=require("assert"),ce=100,ae=Buffer.allocUnsafe(0),js=16*1024,dr="buffer",yr="utf8",[Ts,Rs]=(process.versions.node||"0.0").split(".").map(Number),ks=Ts>=22&&Rs>=7;function mr(e,t){t._opening=!0,t._writing=!0,t._asyncDrainScheduled=!1;function r(o,a){if(o){t._reopening=!1,t._writing=!1,t._opening=!1,t.sync?process.nextTick(()=>{t.listenerCount("error")>0&&t.emit("error",o)}):t.emit("error",o);return}let f=t._reopening;t.fd=a,t.file=e,t._reopening=!1,t._opening=!1,t._writing=!1,t.sync?process.nextTick(()=>t.emit("ready")):t.emit("ready"),!t.destroyed&&(!t._writing&&t._len>t.minLength||t._flushPending?t._actualWrite():f&&process.nextTick(()=>t.emit("drain")))}let n=t.append?"a":"w",i=t.mode;if(t.sync)try{t.mkdir&&j.mkdirSync(hr.dirname(e),{recursive:!0});let o=j.openSync(e,n,i);r(null,o)}catch(o){throw r(o),o}else t.mkdir?j.mkdir(hr.dirname(e),{recursive:!0},o=>{if(o)return r(o);j.open(e,n,i,r)}):j.open(e,n,i,r)}function I(e){if(!(this instanceof I))return new I(e);let{fd:t,dest:r,minLength:n,maxLength:i,maxWrite:o,periodicFlush:a,sync:f,append:c=!0,mkdir:h,retryEAGAIN:u,fsync:l,contentMode:p,mode:d}=e||{};t=t||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(n||0,16387),this.file=null,this.destroyed=!1,this.minLength=n||0,this.maxLength=i||0,this.maxWrite=o||js,this._periodicFlush=a||0,this._periodicFlushTimer=void 0,this.sync=f||!1,this.writable=!0,this._fsync=l||!1,this.append=c||!1,this.mode=d,this.retryEAGAIN=u||(()=>!0),this.mkdir=h||!1;let s,g;if(p===dr)this._writingBuf=ae,this.write=qs,this.flush=Ds,this.flushSync=Ps,this._actualWrite=Ws,s=()=>j.writeSync(this.fd,this._writingBuf),g=()=>j.write(this.fd,this._writingBuf,this.release);else if(p===void 0||p===yr)this._writingBuf="",this.write=Cs,this.flush=Is,this.flushSync=Ns,this._actualWrite=Ms,s=()=>j.writeSync(this.fd,this._writingBuf,"utf8"),g=()=>j.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${yr}" and "${dr}", but passed ${p}`);if(typeof t=="number")this.fd=t,process.nextTick(()=>this.emit("ready"));else if(typeof t=="string")mr(t,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(m,S)=>{if(m){if((m.code==="EAGAIN"||m.code==="EBUSY")&&this.retryEAGAIN(m,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{Fe(ce),this.release(void 0,0)}catch(_){this.release(_)}else setTimeout(g,ce);else this._writing=!1,this.emit("error",m);return}this.emit("write",S);let b=ze(this._writingBuf,this._len,S);if(this._len=b.len,this._writingBuf=b.writingBuf,this._writingBuf.length){if(!this.sync){g();return}try{do{let _=s(),O=ze(this._writingBuf,this._len,_);this._len=O.len,this._writingBuf=O.writingBuf}while(this._writingBuf.length)}catch(_){this.release(_);return}}this._fsync&&j.fsyncSync(this.fd);let w=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):w>this.minLength?this._actualWrite():this._ending?w>0?this._actualWrite():(this._writing=!1,he(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(Bs,this)):this.emit("drain"))},this.on("newListener",function(m){m==="drain"&&(this._asyncDrainScheduled=!1)}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function ze(e,t,r){return typeof e=="string"&&Buffer.byteLength(e)!==r&&(r=Buffer.from(e).subarray(0,r).toString().length),t=Math.max(t-r,0),e=e.slice(r),{writingBuf:e,len:t}}function Bs(e){e.listenerCount("drain")>0&&(e._asyncDrainScheduled=!1,e.emit("drain"))}$s(I,Ls);function gr(e,t){return e.length===0?ae:e.length===1?e[0]:Buffer.concat(e,t)}function Cs(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||r[r.length-1].length+e.length>this.maxWrite?r.push(""+e):r[r.length-1]+=e,this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function qs(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs,n=this._lens;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||n[n.length-1]+e.length>this.maxWrite?(r.push([e]),n.push(e.length)):(r[r.length-1].push(e),n[n.length-1]+=e.length),this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function pr(e){this._flushPending=!0;let t=()=>{if(this._fsync)this._flushPending=!1,e();else try{j.fsync(this.fd,n=>{this._flushPending=!1,e(n)})}catch(n){e(n)}this.off("error",r)},r=n=>{this._flushPending=!1,e(n),this.off("drain",t)};this.once("drain",t),this.once("error",r)}function Is(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&pr.call(this,e),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function Ds(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&pr.call(this,e),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}I.prototype.reopen=function(e){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(e)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(e&&(this.file=e),this._reopening=!0,this._writing)return;let t=this.fd;this.once("ready",()=>{t!==this.fd&&j.close(t,r=>{if(r)return this.emit("error",r)})}),mr(this.file,this)};I.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():he(this)))};function Ns(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let e="";for(;this._bufs.length||e;){e.length<=0&&(e=this._bufs[0]);try{let t=j.writeSync(this.fd,e,"utf8"),r=ze(e,this._len,t);e=r.writingBuf,this._len=r.len,e.length<=0&&this._bufs.shift()}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Fe(ce)}}try{j.fsyncSync(this.fd)}catch{}}function Ps(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=ae);let e=ae;for(;this._bufs.length||e.length;){e.length<=0&&(e=gr(this._bufs[0],this._lens[0]));try{let t=j.writeSync(this.fd,e);e=e.subarray(t),this._len=Math.max(this._len-t,0),e.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Fe(ce)}}}I.prototype.destroy=function(){this.destroyed||he(this)};function Ms(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let t=j.writeSync(this.fd,this._writingBuf,"utf8");e(null,t)}catch(t){e(t)}else j.write(this.fd,this._writingBuf,"utf8",e)}function Ws(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:gr(this._bufs.shift(),this._lens.shift()),this.sync)try{let t=j.writeSync(this.fd,this._writingBuf);e(null,t)}catch(t){e(t)}else ks&&(this._writingBuf=Buffer.from(this._writingBuf)),j.write(this.fd,this._writingBuf,e)}function he(e){if(e.fd===-1){e.once("ready",he.bind(null,e));return}e._periodicFlushTimer!==void 0&&clearInterval(e._periodicFlushTimer),e.destroyed=!0,e._bufs=[],e._lens=[],As(typeof e.fd=="number",`sonic.fd must be a number, got ${typeof e.fd}`);try{j.fsync(e.fd,t)}catch{}function t(){e.fd!==1&&e.fd!==2?j.close(e.fd,r):r()}function r(n){if(n){e.emit("error",n);return}e._ending&&!e._writing&&e.emit("finish"),e.emit("close")}}I.SonicBoom=I;I.default=I;br.exports=I});var Ve=v((ku,Or)=>{"use strict";var D={exit:[],beforeExit:[]},Sr={exit:Vs,beforeExit:Ks},X;function zs(){X===void 0&&(X=new FinalizationRegistry(Us))}function Fs(e){D[e].length>0||process.on(e,Sr[e])}function _r(e){D[e].length>0||(process.removeListener(e,Sr[e]),D.exit.length===0&&D.beforeExit.length===0&&(X=void 0))}function Vs(){Er("exit")}function Ks(){Er("beforeExit")}function Er(e){for(let t of D[e]){let r=t.deref(),n=t.fn;r!==void 0&&n(r,e)}D[e]=[]}function Us(e){for(let t of["exit","beforeExit"]){let r=D[t].indexOf(e);D[t].splice(r,r+1),_r(t)}}function vr(e,t,r){if(t===void 0)throw new Error("the object can't be undefined");Fs(e);let n=new WeakRef(t);n.fn=r,zs(),X.register(t,n),D[e].push(n)}function Js(e,t){vr("exit",e,t)}function Gs(e,t){vr("beforeExit",e,t)}function Hs(e){if(X!==void 0){X.unregister(e);for(let t of["exit","beforeExit"])D[t]=D[t].filter(r=>{let n=r.deref();return n&&n!==e}),_r(t)}}Or.exports={register:Js,registerBeforeExit:Gs,unregister:Hs}});var xr=v((Bu,Xs)=>{Xs.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}});var $r=v((Cu,Lr)=>{"use strict";function Ys(e,t,r,n,i){let o=Date.now()+n,a=Atomics.load(e,t);if(a===r){i(null,"ok");return}let f=a,c=h=>{Date.now()>o?i(null,"timed-out"):setTimeout(()=>{f=a,a=Atomics.load(e,t),a===f?c(h>=1e3?1e3:h*2):a===r?i(null,"ok"):i(null,"not-equal")},h)};c(1)}function Qs(e,t,r,n,i){let o=Date.now()+n,a=Atomics.load(e,t);if(a!==r){i(null,"ok");return}let f=c=>{Date.now()>o?i(null,"timed-out"):setTimeout(()=>{a=Atomics.load(e,t),a!==r?i(null,"ok"):f(c>=1e3?1e3:c*2)},c)};f(1)}Lr.exports={wait:Ys,waitDiff:Qs}});var jr=v((qu,Ar)=>{"use strict";Ar.exports={WRITE_INDEX:4,READ_INDEX:8}});var Cr=v((Iu,Br)=>{"use strict";var{version:Zs}=xr(),{EventEmitter:eo}=require("events"),{Worker:to}=require("worker_threads"),{join:ro}=require("path"),{pathToFileURL:no}=require("url"),{wait:io}=$r(),{WRITE_INDEX:k,READ_INDEX:N}=jr(),so=require("buffer"),oo=require("assert"),y=Symbol("kImpl"),lo=so.constants.MAX_STRING_LENGTH,ee=class{constructor(t){this._value=t}deref(){return this._value}},ye=class{register(){}unregister(){}},fo=process.env.NODE_V8_COVERAGE?ye:global.FinalizationRegistry||ye,uo=process.env.NODE_V8_COVERAGE?ee:global.WeakRef||ee,Tr=new fo(e=>{e.exited||e.terminate()});function co(e,t){let{filename:r,workerData:n}=t,o=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||ro(__dirname,"lib","worker.js"),a=new to(o,{...t.workerOpts,trackUnmanagedFds:!1,workerData:{filename:r.indexOf("file://")===0?r:no(r).href,dataBuf:e[y].dataBuf,stateBuf:e[y].stateBuf,workerData:{$context:{threadStreamVersion:Zs},...n}}});return a.stream=new ee(e),a.on("message",ao),a.on("exit",kr),Tr.register(e,a),a}function Rr(e){oo(!e[y].sync),e[y].needDrain&&(e[y].needDrain=!1,e.emit("drain"))}function de(e){let t=Atomics.load(e[y].state,k),r=e[y].data.length-t;if(r>0){if(e[y].buf.length===0){e[y].flushing=!1,e[y].ending?He(e):e[y].needDrain&&process.nextTick(Rr,e);return}let n=e[y].buf.slice(0,r),i=Buffer.byteLength(n);i<=r?(e[y].buf=e[y].buf.slice(r),me(e,n,de.bind(null,e))):e.flush(()=>{if(!e.destroyed){for(Atomics.store(e[y].state,N,0),Atomics.store(e[y].state,k,0);i>e[y].data.length;)r=r/2,n=e[y].buf.slice(0,r),i=Buffer.byteLength(n);e[y].buf=e[y].buf.slice(r),me(e,n,de.bind(null,e))}})}else if(r===0){if(t===0&&e[y].buf.length===0)return;e.flush(()=>{Atomics.store(e[y].state,N,0),Atomics.store(e[y].state,k,0),de(e)})}else P(e,new Error("overwritten"))}function ao(e){let t=this.stream.deref();if(t===void 0){this.exited=!0,this.terminate();return}switch(e.code){case"READY":this.stream=new uo(t),t.flush(()=>{t[y].ready=!0,t.emit("ready")});break;case"ERROR":P(t,e.err);break;case"EVENT":Array.isArray(e.args)?t.emit(e.name,...e.args):t.emit(e.name,e.args);break;case"WARNING":process.emitWarning(e.err);break;default:P(t,new Error("this should not happen: "+e.code))}}function kr(e){let t=this.stream.deref();t!==void 0&&(Tr.unregister(t),t.worker.exited=!0,t.worker.off("exit",kr),P(t,e!==0?new Error("the worker thread exited"):null))}var Ue=class extends eo{constructor(t={}){if(super(),t.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[y]={},this[y].stateBuf=new SharedArrayBuffer(128),this[y].state=new Int32Array(this[y].stateBuf),this[y].dataBuf=new SharedArrayBuffer(t.bufferSize||4*1024*1024),this[y].data=Buffer.from(this[y].dataBuf),this[y].sync=t.sync||!1,this[y].ending=!1,this[y].ended=!1,this[y].needDrain=!1,this[y].destroyed=!1,this[y].flushing=!1,this[y].ready=!1,this[y].finished=!1,this[y].errored=null,this[y].closed=!1,this[y].buf="",this.worker=co(this,t),this.on("message",(r,n)=>{this.worker.postMessage(r,n)})}write(t){if(this[y].destroyed)return Je(this,new Error("the worker has exited")),!1;if(this[y].ending)return Je(this,new Error("the worker is ending")),!1;if(this[y].flushing&&this[y].buf.length+t.length>=lo)try{Ke(this),this[y].flushing=!0}catch(r){return P(this,r),!1}if(this[y].buf+=t,this[y].sync)try{return Ke(this),!0}catch(r){return P(this,r),!1}return this[y].flushing||(this[y].flushing=!0,setImmediate(de,this)),this[y].needDrain=this[y].data.length-this[y].buf.length-Atomics.load(this[y].state,k)<=0,!this[y].needDrain}end(){this[y].destroyed||(this[y].ending=!0,He(this))}flush(t){if(this[y].destroyed){typeof t=="function"&&process.nextTick(t,new Error("the worker has exited"));return}let r=Atomics.load(this[y].state,k);io(this[y].state,N,r,1/0,(n,i)=>{if(n){P(this,n),process.nextTick(t,n);return}if(i==="not-equal"){this.flush(t);return}process.nextTick(t)})}flushSync(){this[y].destroyed||(Ke(this),Ge(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[y].ready}get destroyed(){return this[y].destroyed}get closed(){return this[y].closed}get writable(){return!this[y].destroyed&&!this[y].ending}get writableEnded(){return this[y].ending}get writableFinished(){return this[y].finished}get writableNeedDrain(){return this[y].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[y].errored}};function Je(e,t){setImmediate(()=>{e.emit("error",t)})}function P(e,t){e[y].destroyed||(e[y].destroyed=!0,t&&(e[y].errored=t,Je(e,t)),e.worker.exited?setImmediate(()=>{e[y].closed=!0,e.emit("close")}):e.worker.terminate().catch(()=>{}).then(()=>{e[y].closed=!0,e.emit("close")}))}function me(e,t,r){let n=Atomics.load(e[y].state,k),i=Buffer.byteLength(t);return e[y].data.write(t,n),Atomics.store(e[y].state,k,n+i),Atomics.notify(e[y].state,k),r(),!0}function He(e){if(!(e[y].ended||!e[y].ending||e[y].flushing)){e[y].ended=!0;try{e.flushSync();let t=Atomics.load(e[y].state,N);Atomics.store(e[y].state,k,-1),Atomics.notify(e[y].state,k);let r=0;for(;t!==-1;){if(Atomics.wait(e[y].state,N,t,1e3),t=Atomics.load(e[y].state,N),t===-2){P(e,new Error("end() failed"));return}if(++r===10){P(e,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{e[y].finished=!0,e.emit("finish")})}catch(t){P(e,t)}}}function Ke(e){let t=()=>{e[y].ending?He(e):e[y].needDrain&&process.nextTick(Rr,e)};for(e[y].flushing=!1;e[y].buf.length!==0;){let r=Atomics.load(e[y].state,k),n=e[y].data.length-r;if(n===0){Ge(e),Atomics.store(e[y].state,N,0),Atomics.store(e[y].state,k,0);continue}else if(n<0)throw new Error("overwritten");let i=e[y].buf.slice(0,n),o=Buffer.byteLength(i);if(o<=n)e[y].buf=e[y].buf.slice(n),me(e,i,t);else{for(Ge(e),Atomics.store(e[y].state,N,0),Atomics.store(e[y].state,k,0);o>e[y].buf.length;)n=n/2,i=e[y].buf.slice(0,n),o=Buffer.byteLength(i);e[y].buf=e[y].buf.slice(n),me(e,i,t)}}}function Ge(e){if(e[y].flushing)throw new Error("unable to flush while flushing");let t=Atomics.load(e[y].state,k),r=0;for(;;){let n=Atomics.load(e[y].state,N);if(n===-2)throw Error("_flushSync failed");if(n!==t)Atomics.wait(e[y].state,N,n,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}Br.exports=Ue});var Qe=v((Du,qr)=>{"use strict";var{createRequire:ho}=require("module"),yo=ke(),{join:Xe,isAbsolute:mo,sep:go}=require("node:path"),po=We(),Ye=Ve(),bo=Cr();function wo(e){Ye.register(e,_o),Ye.registerBeforeExit(e,Eo),e.on("close",function(){Ye.unregister(e)})}function So(e,t,r,n){let i=new bo({filename:e,workerData:t,workerOpts:r,sync:n});i.on("ready",o),i.on("close",function(){process.removeListener("exit",a)}),process.on("exit",a);function o(){process.removeListener("exit",a),i.unref(),r.autoEnd!==!1&&wo(i)}function a(){i.closed||(i.flushSync(),po(100),i.end())}return i}function _o(e){e.ref(),e.flushSync(),e.end(),e.once("close",function(){e.unref()})}function Eo(e){e.flushSync()}function vo(e){let{pipeline:t,targets:r,levels:n,dedupe:i,worker:o={},caller:a=yo(),sync:f=!1}=e,c={...e.options},h=typeof a=="string"?[a]:a,u="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},l=e.target;if(l&&r)throw new Error("only one of target or targets can be specified");return r?(l=u["pino-worker"]||Xe(__dirname,"worker.js"),c.targets=r.filter(d=>d.target).map(d=>({...d,target:p(d.target)})),c.pipelines=r.filter(d=>d.pipeline).map(d=>d.pipeline.map(s=>({...s,level:d.level,target:p(s.target)})))):t&&(l=u["pino-worker"]||Xe(__dirname,"worker.js"),c.pipelines=[t.map(d=>({...d,target:p(d.target)}))]),n&&(c.levels=n),i&&(c.dedupe=i),c.pinoWillSendConfig=!0,So(p(l),c,o,f);function p(d){if(d=u[d]||d,mo(d)||d.indexOf("file://")===0)return d;if(d==="pino/file")return Xe(__dirname,"..","file.js");let s;for(let g of h)try{let m=g==="node:repl"?process.cwd()+go:g;s=ho(m).resolve(d);break}catch{continue}if(!s)throw new Error(`unable to determine transport target for "${d}"`);return s}}qr.exports=vo});var be=v((Nu,Ur)=>{"use strict";var Ir=ar(),{mapHttpRequest:Oo,mapHttpResponse:xo}=Re(),et=wr(),Dr=Ve(),{lsCacheSym:Lo,chindingsSym:Mr,writeSym:Nr,serializersSym:Wr,formatOptsSym:Pr,endSym:$o,stringifiersSym:zr,stringifySym:Fr,stringifySafeSym:tt,wildcardFirstSym:Vr,nestedKeySym:Ao,formattersSym:Kr,messageKeySym:jo,errorKeySym:To,nestedKeyStrSym:Ro,msgPrefixSym:ge}=H(),{isMainThread:ko}=require("worker_threads"),Bo=Qe();function Y(){}function Co(e,t){if(!t)return r;return function(...i){t.call(this,i,r,e)};function r(n,...i){if(typeof n=="object"){let o=n;n!==null&&(n.method&&n.headers&&n.socket?n=Oo(n):typeof n.setHeader=="function"&&(n=xo(n)));let a;o===null&&i.length===0?a=[null]:(o=i.shift(),a=i),typeof this[ge]=="string"&&o!==void 0&&o!==null&&(o=this[ge]+o),this[Nr](n,Ir(o,a,this[Pr]),e)}else{let o=n===void 0?i.shift():n;typeof this[ge]=="string"&&o!==void 0&&o!==null&&(o=this[ge]+o),this[Nr](null,Ir(o,i,this[Pr]),e)}}}function Ze(e){let t="",r=0,n=!1,i=255,o=e.length;if(o>100)return JSON.stringify(e);for(var a=0;a<o&&i>=32;a++)i=e.charCodeAt(a),(i===34||i===92)&&(t+=e.slice(r,a)+"\\",r=a,n=!0);return n?t+=e.slice(r):t=e,i<32?JSON.stringify(e):'"'+t+'"'}function qo(e,t,r,n){let i=this[Fr],o=this[tt],a=this[zr],f=this[$o],c=this[Mr],h=this[Wr],u=this[Kr],l=this[jo],p=this[To],d=this[Lo][r]+n;d=d+c;let s;u.log&&(e=u.log(e));let g=a[Vr],m="";for(let b in e)if(s=e[b],Object.prototype.hasOwnProperty.call(e,b)&&s!==void 0){h[b]?s=h[b](s):b===p&&h.err&&(s=h.err(s));let w=a[b]||g;switch(typeof s){case"undefined":case"function":continue;case"number":Number.isFinite(s)===!1&&(s=null);case"boolean":w&&(s=w(s));break;case"string":s=(w||Ze)(s);break;default:s=(w||i)(s,o)}if(s===void 0)continue;let _=Ze(b);m+=","+_+":"+s}let S="";if(t!==void 0){s=h[l]?h[l](t):t;let b=a[l]||g;switch(typeof s){case"function":break;case"number":Number.isFinite(s)===!1&&(s=null);case"boolean":b&&(s=b(s)),S=',"'+l+'":'+s;break;case"string":s=(b||Ze)(s),S=',"'+l+'":'+s;break;default:s=(b||i)(s,o),S=',"'+l+'":'+s}}return this[Ao]&&m?d+this[Ro]+m.slice(1)+"}"+S+f:d+m+S+f}function Io(e,t){let r,n=e[Mr],i=e[Fr],o=e[tt],a=e[zr],f=a[Vr],c=e[Wr],h=e[Kr].bindings;t=h(t);for(let u in t)if(r=t[u],(u!=="level"&&u!=="serializers"&&u!=="formatters"&&u!=="customLevels"&&t.hasOwnProperty(u)&&r!==void 0)===!0){if(r=c[u]?c[u](r):r,r=(a[u]||f||i)(r,o),r===void 0)continue;n+=',"'+u+'":'+r}return n}function Do(e){return e.write!==e.constructor.prototype.write}var No=process.env.NODE_V8_COVERAGE||process.env.V8_COVERAGE;function pe(e){let t=new et(e);return t.on("error",r),!No&&!e.sync&&ko&&(Dr.register(t,Po),t.on("close",function(){Dr.unregister(t)})),t;function r(n){if(n.code==="EPIPE"){t.write=Y,t.end=Y,t.flushSync=Y,t.destroy=Y;return}t.removeListener("error",r),t.emit("error",n)}}function Po(e,t){e.destroyed||(t==="beforeExit"?(e.flush(),e.on("drain",function(){e.end()})):e.flushSync())}function Mo(e){return function(r,n,i={},o){if(typeof i=="string")o=pe({dest:i}),i={};else if(typeof o=="string"){if(i&&i.transport)throw Error("only one of option.transport or stream can be specified");o=pe({dest:o})}else if(i instanceof et||i.writable||i._writableState)o=i,i={};else if(i.transport){if(i.transport instanceof et||i.transport.writable||i.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(i.transport.targets&&i.transport.targets.length&&i.formatters&&typeof i.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let c;i.customLevels&&(c=i.useOnlyCustomLevels?i.customLevels:Object.assign({},i.levels,i.customLevels)),o=Bo({caller:n,...i.transport,levels:c})}if(i=Object.assign({},e,i),i.serializers=Object.assign({},e.serializers,i.serializers),i.formatters=Object.assign({},e.formatters,i.formatters),i.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:a,onChild:f}=i;return a===!1&&(i.level="silent"),f||(i.onChild=Y),o||(Do(process.stdout)?o=process.stdout:o=pe({fd:process.stdout.fd||1})),{opts:i,stream:o}}}function Wo(e,t){try{return JSON.stringify(e)}catch{try{return(t||this[tt])(e)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function zo(e,t,r){return{level:e,bindings:t,log:r}}function Fo(e){let t=Number(e);return typeof e=="string"&&Number.isFinite(t)?t:e===void 0?1:e}Ur.exports={noop:Y,buildSafeSonicBoom:pe,asChindings:Io,asJson:qo,genLog:Co,createArgsNormalizer:Mo,stringify:Wo,buildFormatters:zo,normalizeDestFileDescriptor:Fo}});var we=v((Pu,Jr)=>{var Vo={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},Ko={ASC:"ASC",DESC:"DESC"};Jr.exports={DEFAULT_LEVELS:Vo,SORTING_ORDER:Ko}});var it=v((Mu,Yr)=>{"use strict";var{lsCacheSym:Uo,levelValSym:rt,useOnlyCustomLevelsSym:Jo,streamSym:Go,formattersSym:Ho,hooksSym:Xo,levelCompSym:Gr}=H(),{noop:Yo,genLog:K}=be(),{DEFAULT_LEVELS:M,SORTING_ORDER:Hr}=we(),Xr={fatal:e=>{let t=K(M.fatal,e);return function(...r){let n=this[Go];if(t.call(this,...r),typeof n.flushSync=="function")try{n.flushSync()}catch{}}},error:e=>K(M.error,e),warn:e=>K(M.warn,e),info:e=>K(M.info,e),debug:e=>K(M.debug,e),trace:e=>K(M.trace,e)},nt=Object.keys(M).reduce((e,t)=>(e[M[t]]=t,e),{}),Qo=Object.keys(nt).reduce((e,t)=>(e[t]='{"level":'+Number(t),e),{});function Zo(e){let t=e[Ho].level,{labels:r}=e.levels,n={};for(let i in r){let o=t(r[i],Number(i));n[i]=JSON.stringify(o).slice(0,-1)}return e[Uo]=n,e}function el(e,t){if(t)return!1;switch(e){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function tl(e){let{labels:t,values:r}=this.levels;if(typeof e=="number"){if(t[e]===void 0)throw Error("unknown level value"+e);e=t[e]}if(r[e]===void 0)throw Error("unknown level "+e);let n=this[rt],i=this[rt]=r[e],o=this[Jo],a=this[Gr],f=this[Xo].logMethod;for(let c in r){if(a(r[c],i)===!1){this[c]=Yo;continue}this[c]=el(c,o)?Xr[c](f):K(r[c],f)}this.emit("level-change",e,i,t[n],n,this)}function rl(e){let{levels:t,levelVal:r}=this;return t&&t.labels?t.labels[r]:""}function nl(e){let{values:t}=this.levels,r=t[e];return r!==void 0&&this[Gr](r,this[rt])}function il(e,t,r){return e===Hr.DESC?t<=r:t>=r}function sl(e){return typeof e=="string"?il.bind(null,e):e}function ol(e=null,t=!1){let r=e?Object.keys(e).reduce((o,a)=>(o[e[a]]=a,o),{}):null,n=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),t?null:nt,r),i=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),t?null:M,e);return{labels:n,values:i}}function ll(e,t,r){if(typeof e=="number"){if(![].concat(Object.keys(t||{}).map(o=>t[o]),r?[]:Object.keys(nt).map(o=>+o),1/0).includes(e))throw Error(`default level:${e} must be included in custom levels`);return}let n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:M,t);if(!(e in n))throw Error(`default level:${e} must be included in custom levels`)}function fl(e,t){let{labels:r,values:n}=e;for(let i in t){if(i in n)throw Error("levels cannot be overridden");if(t[i]in r)throw Error("pre-existing level values cannot be used for new levels")}}function ul(e){if(typeof e!="function"&&!(typeof e=="string"&&Object.values(Hr).includes(e)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}Yr.exports={initialLsCache:Qo,genLsCache:Zo,levelMethods:Xr,getLevel:rl,setLevel:tl,isLevelEnabled:nl,mappings:ol,assertNoLevelCollisions:fl,assertDefaultLevelFound:ll,genLevelComparison:sl,assertLevelComparison:ul}});var st=v((Wu,Qr)=>{"use strict";Qr.exports={version:"9.6.0"}});var cn=v((Fu,un)=>{"use strict";var{EventEmitter:cl}=require("node:events"),{lsCacheSym:al,levelValSym:hl,setLevelSym:lt,getLevelSym:Zr,chindingsSym:ft,parsedChindingsSym:dl,mixinSym:yl,asJsonSym:sn,writeSym:ml,mixinMergeStrategySym:gl,timeSym:pl,timeSliceIndexSym:bl,streamSym:on,serializersSym:U,formattersSym:ot,errorKeySym:wl,messageKeySym:Sl,useOnlyCustomLevelsSym:_l,needsMetadataGsym:El,redactFmtSym:vl,stringifySym:Ol,formatOptsSym:xl,stringifiersSym:Ll,msgPrefixSym:en,hooksSym:$l}=H(),{getLevel:Al,setLevel:jl,isLevelEnabled:Tl,mappings:Rl,initialLsCache:kl,genLsCache:Bl,assertNoLevelCollisions:Cl}=it(),{asChindings:ln,asJson:ql,buildFormatters:tn,stringify:rn}=be(),{version:Il}=st(),Dl=Pe(),Nl=class{},fn={constructor:Nl,child:Pl,bindings:Ml,setBindings:Wl,flush:Kl,isLevelEnabled:Tl,version:Il,get level(){return this[Zr]()},set level(e){this[lt](e)},get levelVal(){return this[hl]},set levelVal(e){throw Error("levelVal is read-only")},[al]:kl,[ml]:Fl,[sn]:ql,[Zr]:Al,[lt]:jl};Object.setPrototypeOf(fn,cl.prototype);un.exports=function(){return Object.create(fn)};var nn=e=>e;function Pl(e,t){if(!e)throw Error("missing bindings for child Pino");t=t||{};let r=this[U],n=this[ot],i=Object.create(this);if(t.hasOwnProperty("serializers")===!0){i[U]=Object.create(null);for(let u in r)i[U][u]=r[u];let c=Object.getOwnPropertySymbols(r);for(var o=0;o<c.length;o++){let u=c[o];i[U][u]=r[u]}for(let u in t.serializers)i[U][u]=t.serializers[u];let h=Object.getOwnPropertySymbols(t.serializers);for(var a=0;a<h.length;a++){let u=h[a];i[U][u]=t.serializers[u]}}else i[U]=r;if(t.hasOwnProperty("formatters")){let{level:c,bindings:h,log:u}=t.formatters;i[ot]=tn(c||n.level,h||nn,u||n.log)}else i[ot]=tn(n.level,nn,n.log);if(t.hasOwnProperty("customLevels")===!0&&(Cl(this.levels,t.customLevels),i.levels=Rl(t.customLevels,i[_l]),Bl(i)),typeof t.redact=="object"&&t.redact!==null||Array.isArray(t.redact)){i.redact=t.redact;let c=Dl(i.redact,rn),h={stringify:c[vl]};i[Ol]=rn,i[Ll]=c,i[xl]=h}typeof t.msgPrefix=="string"&&(i[en]=(this[en]||"")+t.msgPrefix),i[ft]=ln(i,e);let f=t.level||this.level;return i[lt](f),this.onChild(i),i}function Ml(){let t=`{${this[ft].substr(1)}}`,r=JSON.parse(t);return delete r.pid,delete r.hostname,r}function Wl(e){let t=ln(this,e);this[ft]=t,delete this[dl]}function zl(e,t){return Object.assign(t,e)}function Fl(e,t,r){let n=this[pl](),i=this[yl],o=this[wl],a=this[Sl],f=this[gl]||zl,c,h=this[$l].streamWrite;e==null?c={}:e instanceof Error?(c={[o]:e},t===void 0&&(t=e.message)):(c=e,t===void 0&&e[a]===void 0&&e[o]&&(t=e[o].message)),i&&(c=f(c,i(c,r,this)));let u=this[sn](c,t,r,n),l=this[on];l[El]===!0&&(l.lastLevel=r,l.lastObj=c,l.lastMsg=t,l.lastTime=n.slice(this[bl]),l.lastLogger=this),l.write(h?h(u):u)}function Vl(){}function Kl(e){if(e!=null&&typeof e!="function")throw Error("callback must be a function");let t=this[on];typeof t.flush=="function"?t.flush(e||Vl):e&&e()}});var yn=v((ht,dn)=>{"use strict";var{hasOwnProperty:te}=Object.prototype,G=at();G.configure=at;G.stringify=G;G.default=G;ht.stringify=G;ht.configure=at;dn.exports=G;var Ul=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function z(e){return e.length<5e3&&!Ul.test(e)?`"${e}"`:JSON.stringify(e)}function ut(e,t){if(e.length>200||t)return e.sort(t);for(let r=1;r<e.length;r++){let n=e[r],i=r;for(;i!==0&&e[i-1]>n;)e[i]=e[i-1],i--;e[i]=n}return e}var Jl=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function ct(e){return Jl.call(e)!==void 0&&e.length!==0}function an(e,t,r){e.length<r&&(r=e.length);let n=t===","?"":" ",i=`"0":${n}${e[0]}`;for(let o=1;o<r;o++)i+=`${t}"${o}":${n}${e[o]}`;return i}function Gl(e){if(te.call(e,"circularValue")){let t=e.circularValue;if(typeof t=="string")return`"${t}"`;if(t==null)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function Hl(e){let t;if(te.call(e,"deterministic")&&(t=e.deterministic,typeof t!="boolean"&&typeof t!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return t===void 0?!0:t}function Xl(e,t){let r;if(te.call(e,t)&&(r=e[t],typeof r!="boolean"))throw new TypeError(`The "${t}" argument must be of type boolean`);return r===void 0?!0:r}function hn(e,t){let r;if(te.call(e,t)){if(r=e[t],typeof r!="number")throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return r===void 0?1/0:r}function J(e){return e===1?"1 item":`${e} items`}function Yl(e){let t=new Set;for(let r of e)(typeof r=="string"||typeof r=="number")&&t.add(String(r));return t}function Ql(e){if(te.call(e,"strict")){let t=e.strict;if(typeof t!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(t)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}function at(e){e={...e};let t=Ql(e);t&&(e.bigint===void 0&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));let r=Gl(e),n=Xl(e,"bigint"),i=Hl(e),o=typeof i=="function"?i:void 0,a=hn(e,"maximumDepth"),f=hn(e,"maximumBreadth");function c(d,s,g,m,S,b){let w=s[d];switch(typeof w=="object"&&w!==null&&typeof w.toJSON=="function"&&(w=w.toJSON(d)),w=m.call(s,d,w),typeof w){case"string":return z(w);case"object":{if(w===null)return"null";if(g.indexOf(w)!==-1)return r;let _="",O=",",x=b;if(Array.isArray(w)){if(w.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(w),S!==""&&(b+=S,_+=`
${b}`,O=`,
${b}`);let T=Math.min(w.length,f),B=0;for(;B<T-1;B++){let V=c(String(B),w,g,m,S,b);_+=V!==void 0?V:"null",_+=O}let C=c(String(B),w,g,m,S,b);if(_+=C!==void 0?C:"null",w.length-1>f){let V=w.length-f-1;_+=`${O}"... ${J(V)} not stringified"`}return S!==""&&(_+=`
${x}`),g.pop(),`[${_}]`}let L=Object.keys(w),$=L.length;if($===0)return"{}";if(a<g.length+1)return'"[Object]"';let E="",A="";S!==""&&(b+=S,O=`,
${b}`,E=" ");let R=Math.min($,f);i&&!ct(w)&&(L=ut(L,o)),g.push(w);for(let T=0;T<R;T++){let B=L[T],C=c(B,w,g,m,S,b);C!==void 0&&(_+=`${A}${z(B)}:${E}${C}`,A=O)}if($>f){let T=$-f;_+=`${A}"...":${E}"${J(T)} not stringified"`,A=O}return S!==""&&A.length>1&&(_=`
${b}${_}
${x}`),g.pop(),`{${_}}`}case"number":return isFinite(w)?String(w):t?t(w):"null";case"boolean":return w===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(w);default:return t?t(w):void 0}}function h(d,s,g,m,S,b){switch(typeof s=="object"&&s!==null&&typeof s.toJSON=="function"&&(s=s.toJSON(d)),typeof s){case"string":return z(s);case"object":{if(s===null)return"null";if(g.indexOf(s)!==-1)return r;let w=b,_="",O=",";if(Array.isArray(s)){if(s.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(s),S!==""&&(b+=S,_+=`
${b}`,O=`,
${b}`);let $=Math.min(s.length,f),E=0;for(;E<$-1;E++){let R=h(String(E),s[E],g,m,S,b);_+=R!==void 0?R:"null",_+=O}let A=h(String(E),s[E],g,m,S,b);if(_+=A!==void 0?A:"null",s.length-1>f){let R=s.length-f-1;_+=`${O}"... ${J(R)} not stringified"`}return S!==""&&(_+=`
${w}`),g.pop(),`[${_}]`}g.push(s);let x="";S!==""&&(b+=S,O=`,
${b}`,x=" ");let L="";for(let $ of m){let E=h($,s[$],g,m,S,b);E!==void 0&&(_+=`${L}${z($)}:${x}${E}`,L=O)}return S!==""&&L.length>1&&(_=`
${b}${_}
${w}`),g.pop(),`{${_}}`}case"number":return isFinite(s)?String(s):t?t(s):"null";case"boolean":return s===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(s);default:return t?t(s):void 0}}function u(d,s,g,m,S){switch(typeof s){case"string":return z(s);case"object":{if(s===null)return"null";if(typeof s.toJSON=="function"){if(s=s.toJSON(d),typeof s!="object")return u(d,s,g,m,S);if(s===null)return"null"}if(g.indexOf(s)!==-1)return r;let b=S;if(Array.isArray(s)){if(s.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(s),S+=m;let E=`
${S}`,A=`,
${S}`,R=Math.min(s.length,f),T=0;for(;T<R-1;T++){let C=u(String(T),s[T],g,m,S);E+=C!==void 0?C:"null",E+=A}let B=u(String(T),s[T],g,m,S);if(E+=B!==void 0?B:"null",s.length-1>f){let C=s.length-f-1;E+=`${A}"... ${J(C)} not stringified"`}return E+=`
${b}`,g.pop(),`[${E}]`}let w=Object.keys(s),_=w.length;if(_===0)return"{}";if(a<g.length+1)return'"[Object]"';S+=m;let O=`,
${S}`,x="",L="",$=Math.min(_,f);ct(s)&&(x+=an(s,O,f),w=w.slice(s.length),$-=s.length,L=O),i&&(w=ut(w,o)),g.push(s);for(let E=0;E<$;E++){let A=w[E],R=u(A,s[A],g,m,S);R!==void 0&&(x+=`${L}${z(A)}: ${R}`,L=O)}if(_>f){let E=_-f;x+=`${L}"...": "${J(E)} not stringified"`,L=O}return L!==""&&(x=`
${S}${x}
${b}`),g.pop(),`{${x}}`}case"number":return isFinite(s)?String(s):t?t(s):"null";case"boolean":return s===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(s);default:return t?t(s):void 0}}function l(d,s,g){switch(typeof s){case"string":return z(s);case"object":{if(s===null)return"null";if(typeof s.toJSON=="function"){if(s=s.toJSON(d),typeof s!="object")return l(d,s,g);if(s===null)return"null"}if(g.indexOf(s)!==-1)return r;let m="",S=s.length!==void 0;if(S&&Array.isArray(s)){if(s.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(s);let x=Math.min(s.length,f),L=0;for(;L<x-1;L++){let E=l(String(L),s[L],g);m+=E!==void 0?E:"null",m+=","}let $=l(String(L),s[L],g);if(m+=$!==void 0?$:"null",s.length-1>f){let E=s.length-f-1;m+=`,"... ${J(E)} not stringified"`}return g.pop(),`[${m}]`}let b=Object.keys(s),w=b.length;if(w===0)return"{}";if(a<g.length+1)return'"[Object]"';let _="",O=Math.min(w,f);S&&ct(s)&&(m+=an(s,",",f),b=b.slice(s.length),O-=s.length,_=","),i&&(b=ut(b,o)),g.push(s);for(let x=0;x<O;x++){let L=b[x],$=l(L,s[L],g);$!==void 0&&(m+=`${_}${z(L)}:${$}`,_=",")}if(w>f){let x=w-f;m+=`${_}"...":"${J(x)} not stringified"`}return g.pop(),`{${m}}`}case"number":return isFinite(s)?String(s):t?t(s):"null";case"boolean":return s===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(s);default:return t?t(s):void 0}}function p(d,s,g){if(arguments.length>1){let m="";if(typeof g=="number"?m=" ".repeat(Math.min(g,10)):typeof g=="string"&&(m=g.slice(0,10)),s!=null){if(typeof s=="function")return c("",{"":d},[],s,m,"");if(Array.isArray(s))return h("",d,[],Yl(s),m,"")}if(m.length!==0)return u("",d,[],m,"")}return l("",d,[])}return p}});var pn=v((Vu,gn)=>{"use strict";var dt=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:mn}=we(),Zl=mn.info;function ef(e,t){let r=0;e=e||[],t=t||{dedupe:!1};let n=Object.create(mn);n.silent=1/0,t.levels&&typeof t.levels=="object"&&Object.keys(t.levels).forEach(l=>{n[l]=t.levels[l]});let i={write:o,add:c,emit:a,flushSync:f,end:h,minLevel:0,streams:[],clone:u,[dt]:!0,streamLevels:n};return Array.isArray(e)?e.forEach(c,i):c.call(i,e),e=null,i;function o(l){let p,d=this.lastLevel,{streams:s}=this,g=0,m;for(let S=rf(s.length,t.dedupe);sf(S,s.length,t.dedupe);S=nf(S,t.dedupe))if(p=s[S],p.level<=d){if(g!==0&&g!==p.level)break;if(m=p.stream,m[dt]){let{lastTime:b,lastMsg:w,lastObj:_,lastLogger:O}=this;m.lastLevel=d,m.lastTime=b,m.lastMsg=w,m.lastObj=_,m.lastLogger=O}m.write(l),t.dedupe&&(g=p.level)}else if(!t.dedupe)break}function a(...l){for(let{stream:p}of this.streams)typeof p.emit=="function"&&p.emit(...l)}function f(){for(let{stream:l}of this.streams)typeof l.flushSync=="function"&&l.flushSync()}function c(l){if(!l)return i;let p=typeof l.write=="function"||l.stream,d=l.write?l:l.stream;if(!p)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:s,streamLevels:g}=this,m;typeof l.levelVal=="number"?m=l.levelVal:typeof l.level=="string"?m=g[l.level]:typeof l.level=="number"?m=l.level:m=Zl;let S={stream:d,level:m,levelVal:void 0,id:r++};return s.unshift(S),s.sort(tf),this.minLevel=s[0].level,i}function h(){for(let{stream:l}of this.streams)typeof l.flushSync=="function"&&l.flushSync(),l.end()}function u(l){let p=new Array(this.streams.length);for(let d=0;d<p.length;d++)p[d]={level:l,stream:this.streams[d].stream};return{write:o,add:c,minLevel:l,streams:p,clone:u,emit:a,flushSync:f,[dt]:!0}}}function tf(e,t){return e.level-t.level}function rf(e,t){return t?e-1:0}function nf(e,t){return t?e-1:e+1}function sf(e,t,r){return r?e>=0:e<t}gn.exports=ef});var Rn=v((Ku,q)=>{function yt(e){try{return require("path").join(`${process.cwd()}${require("path").sep}dist`.replace(/\\/g,"/"),e)}catch{return new Function("p","return new URL(p, import.meta.url).pathname")(e)}}globalThis.__bundlerPathsOverrides={...globalThis.__bundlerPathsOverrides||{},"thread-stream-worker":yt("./thread-stream-worker.js"),"pino-worker":yt("./pino-worker.js"),"pino/file":yt("./pino-file.js")};var of=require("node:os"),xn=Re(),lf=ke(),ff=Pe(),Ln=ur(),uf=cn(),$n=H(),{configure:cf}=yn(),{assertDefaultLevelFound:af,mappings:An,genLsCache:hf,genLevelComparison:df,assertLevelComparison:yf}=it(),{DEFAULT_LEVELS:jn,SORTING_ORDER:mf}=we(),{createArgsNormalizer:gf,asChindings:pf,buildSafeSonicBoom:bn,buildFormatters:bf,stringify:mt,normalizeDestFileDescriptor:wn,noop:wf}=be(),{version:Sf}=st(),{chindingsSym:Sn,redactFmtSym:_f,serializersSym:_n,timeSym:Ef,timeSliceIndexSym:vf,streamSym:Of,stringifySym:En,stringifySafeSym:gt,stringifiersSym:vn,setLevelSym:xf,endSym:Lf,formatOptsSym:$f,messageKeySym:Af,errorKeySym:jf,nestedKeySym:Tf,mixinSym:Rf,levelCompSym:kf,useOnlyCustomLevelsSym:Bf,formattersSym:On,hooksSym:Cf,nestedKeyStrSym:qf,mixinMergeStrategySym:If,msgPrefixSym:Df}=$n,{epochTime:Tn,nullTime:Nf}=Ln,{pid:Pf}=process,Mf=of.hostname(),Wf=xn.err,zf={level:"info",levelComparison:mf.ASC,levels:jn,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:Pf,hostname:Mf},serializers:Object.assign(Object.create(null),{err:Wf}),formatters:Object.assign(Object.create(null),{bindings(e){return e},level(e,t){return{level:t}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:Tn,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},Ff=gf(zf),Vf=Object.assign(Object.create(null),xn);function pt(...e){let t={},{opts:r,stream:n}=Ff(t,lf(),...e);r.level&&typeof r.level=="string"&&jn[r.level.toLowerCase()]!==void 0&&(r.level=r.level.toLowerCase());let{redact:i,crlf:o,serializers:a,timestamp:f,messageKey:c,errorKey:h,nestedKey:u,base:l,name:p,level:d,customLevels:s,levelComparison:g,mixin:m,mixinMergeStrategy:S,useOnlyCustomLevels:b,formatters:w,hooks:_,depthLimit:O,edgeLimit:x,onChild:L,msgPrefix:$}=r,E=cf({maximumDepth:O,maximumBreadth:x}),A=bf(w.level,w.bindings,w.log),R=mt.bind({[gt]:E}),T=i?ff(i,R):{},B=i?{stringify:T[_f]}:{stringify:R},C="}"+(o?`\r
`:`
`),V=pf.bind(null,{[Sn]:"",[_n]:a,[vn]:T,[En]:mt,[gt]:E,[On]:A}),_e="";l!==null&&(p===void 0?_e=V(l):_e=V(Object.assign({},l,{name:p})));let bt=f instanceof Function?f:f?Tn:Nf,Un=bt().indexOf(":")+1;if(b&&!s)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(m&&typeof m!="function")throw Error(`Unknown mixin type "${typeof m}" - expected "function"`);if($&&typeof $!="string")throw Error(`Unknown msgPrefix type "${typeof $}" - expected "string"`);af(d,s,b);let wt=An(s,b);typeof n.emit=="function"&&n.emit("message",{code:"PINO_CONFIG",config:{levels:wt,messageKey:c,errorKey:h}}),yf(g);let Jn=df(g);return Object.assign(t,{levels:wt,[kf]:Jn,[Bf]:b,[Of]:n,[Ef]:bt,[vf]:Un,[En]:mt,[gt]:E,[vn]:T,[Lf]:C,[$f]:B,[Af]:c,[jf]:h,[Tf]:u,[qf]:u?`,${JSON.stringify(u)}:{`:"",[_n]:a,[Rf]:m,[If]:S,[Sn]:_e,[On]:A,[Cf]:_,silent:wf,onChild:L,[Df]:$}),Object.setPrototypeOf(t,uf()),hf(t),t[xf](d),t}q.exports=pt;q.exports.destination=(e=process.stdout.fd)=>typeof e=="object"?(e.dest=wn(e.dest||process.stdout.fd),bn(e)):bn({dest:wn(e),minLength:0});q.exports.transport=Qe();q.exports.multistream=pn();q.exports.levels=An();q.exports.stdSerializers=Vf;q.exports.stdTimeFunctions=Object.assign({},Ln);q.exports.symbols=$n;q.exports.version=Sf;q.exports.default=pt;q.exports.pino=pt});var qn=v((Uu,Cn)=>{"use strict";var{Transform:Kf}=require("stream"),{StringDecoder:Uf}=require("string_decoder"),F=Symbol("last"),Se=Symbol("decoder");function Jf(e,t,r){let n;if(this.overflow){if(n=this[Se].write(e).split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[F]+=this[Se].write(e),n=this[F].split(this.matcher);this[F]=n.pop();for(let i=0;i<n.length;i++)try{Bn(this,this.mapper(n[i]))}catch(o){return r(o)}if(this.overflow=this[F].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function Gf(e){if(this[F]+=this[Se].end(),this[F])try{Bn(this,this.mapper(this[F]))}catch(t){return e(t)}e()}function Bn(e,t){t!==void 0&&e.push(t)}function kn(e){return e}function Hf(e,t,r){switch(e=e||/\r?\n/,t=t||kn,r=r||{},arguments.length){case 1:typeof e=="function"?(t=e,e=/\r?\n/):typeof e=="object"&&!(e instanceof RegExp)&&!e[Symbol.split]&&(r=e,e=/\r?\n/);break;case 2:typeof e=="function"?(r=t,t=e,e=/\r?\n/):typeof t=="object"&&(r=t,t=kn)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=Jf,r.flush=Gf,r.readableObjectMode=!0;let n=new Kf(r);return n[F]="",n[Se]=new Uf("utf8"),n.matcher=e,n.mapper=t,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow||!1,n.overflow=!1,n._destroy=function(i,o){this._writableState.errorEmitted=!1,o(i)},n}Cn.exports=Hf});var Mn=v((Ju,Pn)=>{"use strict";var In=Symbol.for("pino.metadata"),Xf=qn(),{Duplex:Yf}=require("stream"),{parentPort:Dn,workerData:Nn}=require("worker_threads");function Qf(){let e,t,r=new Promise((n,i)=>{e=n,t=i});return r.resolve=e,r.reject=t,r}Pn.exports=function(t,r={}){let n=r.expectPinoConfig===!0&&Nn?.workerData?.pinoWillSendConfig===!0,i=r.parse==="lines",o=typeof r.parseLine=="function"?r.parseLine:JSON.parse,a=r.close||Zf,f=Xf(function(h){let u;try{u=o(h)}catch(l){this.emit("unknown",h,l);return}if(u===null){this.emit("unknown",h,"Null value ignored");return}return typeof u!="object"&&(u={data:u,time:Date.now()}),f[In]&&(f.lastTime=u.time,f.lastLevel=u.level,f.lastObj=u),i?h:u},{autoDestroy:!0});if(f._destroy=function(h,u){let l=a(h,u);l&&typeof l.then=="function"&&l.then(u,u)},r.expectPinoConfig===!0&&Nn?.workerData?.pinoWillSendConfig!==!0&&setImmediate(()=>{f.emit("error",new Error("This transport is not compatible with the current version of pino. Please upgrade pino to the latest version."))}),r.metadata!==!1&&(f[In]=!0,f.lastTime=0,f.lastLevel=0,f.lastObj=null),n){let h={},u=Qf();return Dn.on("message",function l(p){p.code==="PINO_CONFIG"&&(h=p.config,u.resolve(),Dn.off("message",l))}),Object.defineProperties(f,{levels:{get(){return h.levels}},messageKey:{get(){return h.messageKey}},errorKey:{get(){return h.errorKey}}}),u.then(c)}return c();function c(){let h=t(f);if(h&&typeof h.catch=="function")h.catch(u=>{f.destroy(u)}),h=null;else if(r.enablePipelining&&h)return Yf.from({writable:f,readable:h});return f}};function Zf(e,t){process.nextTick(t,e)}});var zn=v((Gu,Wn)=>{var eu=new Function("modulePath","return import(modulePath)");function tu(e){return typeof __non_webpack__require__=="function"?__non_webpack__require__(e):require(e)}Wn.exports={realImport:eu,realRequire:tu}});var Vn=v((Hu,Fn)=>{"use strict";var{realImport:ru,realRequire:re}=zn();Fn.exports=nu;async function nu(e){let t;try{let r=e.startsWith("file://")?e:"file://"+e;r.endsWith(".ts")||r.endsWith(".cts")?(process[Symbol.for("ts-node.register.instance")]?re("ts-node/register"):process.env&&process.env.TS_NODE_DEV&&re("ts-node-dev"),t=re(decodeURIComponent(e))):t=await ru(r)}catch(r){if(r.code==="ENOTDIR"||r.code==="ERR_MODULE_NOT_FOUND")t=re(e);else if(r.code===void 0||r.code==="ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING")try{t=re(decodeURIComponent(e))}catch{throw r}else throw r}if(typeof t=="object"&&(t=t.default),typeof t=="object"&&(t=t.default),typeof t!="function")throw Error("exported worker is not a function");return t}});var iu=require("node:events"),{pipeline:su,PassThrough:ou}=require("node:stream"),lu=Rn(),fu=Mn(),Kn=Vn();module.exports=async function({targets:e,pipelines:t,levels:r,dedupe:n}){let i=[];if(e&&e.length&&(e=await Promise.all(e.map(async f=>{let h=await(await Kn(f.target))(f.options);return{level:f.level,stream:h}})),i.push(...e)),t&&t.length&&(t=await Promise.all(t.map(async f=>{let c,h=await Promise.all(f.map(async u=>(c=u.level,await(await Kn(u.target))(u.options))));return{level:c,stream:a(h)}})),i.push(...t)),i.length===1)return i[0].stream;return fu(o,{parse:"lines",metadata:!0,close(f,c){let h=0;for(let l of i)h++,l.stream.on("close",u),l.stream.end();function u(){--h===0&&c(f)}}});function o(f){let c=lu.multistream(i,{levels:r,dedupe:n});f.on("data",function(h){let{lastTime:u,lastMsg:l,lastObj:p,lastLevel:d}=this;c.lastLevel=d,c.lastTime=u,c.lastMsg=l,c.lastObj=p,c.write(h+`
`)})}function a(f){let c=new iu,h=new ou({autoDestroy:!0,destroy(u,l){c.on("error",l),c.on("closed",l)}});return su(h,...f,function(u){if(u&&u.code!=="ERR_STREAM_PREMATURE_CLOSE"){c.emit("error",u);return}c.emit("closed")}),h}};
//# sourceMappingURL=pino-worker.js.map
